# MyProxy: HTTP Load Balancer

## Описание проекта

MyProxy — это HTTP-балансировщик нагрузки, реализованный на языке Go. Он принимает входящие HTTP-запросы и перенаправляет их на один из заранее заданных бэкенд-серверов. Балансировщик поддерживает алгоритм распределения запросов Round-Robin, обработку ошибок, логирование и периодические проверки состояния бэкендов (Health Checks).

## Основной функционал

### 1. HTTP-сервер
- Сервер принимает входящие запросы на порту, указанном в конфигурационном файле (по умолчанию 8080).
- Используется стандартный HTTP-пакет Go (`net/http`) для обработки запросов и переадресации (reverse proxy).

### 2. Распределение запросов
- Реализован алгоритм Round-Robin для равномерного распределения запросов между бэкендами.
- Балансировщик корректно обрабатывает ситуации, когда один или несколько бэкендов недоступны:
  - Исключает недоступные серверы из пула.
  - Перенаправляет запросы на работающие серверы.
  - Возвращает понятное сообщение об ошибке, если все серверы недоступны.

### 3. Параллелизм и конкурентность
- Обеспечена одновременная обработка нескольких запросов с использованием горутин.
- Используются мьютексы для предотвращения гонок данных.

### 4. Обработка ошибок
- Логируются ошибки при обращении к бэкендам.
- Выводятся понятные сообщения об ошибках в логах.

### 5. Логирование
- Логируются входящие запросы, ошибки и события.
- Используется стандартный пакет `log`.

### 6. Конфигурация
- Конфигурация сервиса задается через файл `config/config.yaml`:
  - Порт для прослушивания.
  - Список бэкенд-серверов.
- Конфигурация независима от кода, что позволяет изменять настройки без перекомпиляции.

## Дополнительные возможности

### Здоровье бэкендов (Health Checks)
- Реализован механизм периодических проверок состояния каждого бэкенда.
- Недоступные серверы временно исключаются из пула, а при восстановлении работы возвращаются обратно.

### Graceful Shutdown
- Балансировщик корректно завершает работу при получении сигналов SIGINT или SIGTERM.
- Завершаются текущие запросы без потери данных.

## Архитектура проекта

Проект разделен на несколько модулей:
- **`internal/config`**: Работа с конфигурацией.
- **`internal/lb`**: Логика балансировки нагрузки.
- **`internal/proxy`**: Реализация прокси-сервера.
- **`internal/middleware`**: Middleware для логирования запросов.

## Запуск проекта



### Запуск с помощью Docker

1. Соберите Docker-образ:
   ```sh
   docker build -t myproxy .
   ```
2. Запустите контейнер:
   ```sh
    docker run -d -p 8080:8080 myproxy
    ```

### Пример конфигурации
```yaml
port: 8080
backends:
  - http://localhost:5001
  - http://localhost:5002
  - http://localhost:5003
```